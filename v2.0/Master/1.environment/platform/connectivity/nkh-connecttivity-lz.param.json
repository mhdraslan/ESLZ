{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "subscriptionId": {
            "value":"5fe2c881-8871-4546-bc4e-07a2e40dbe9e"
        },
        "resourceGroups":{
            "value":{
                "rgSettings":[
                    // ADD RESOURCE GROUP SECTIONS BELOW
                    {
                        "rgName":"rsg-aen-privatednszones-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-fortigate-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-connectivity-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-sharedservices-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-bastion-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-appgatewayprd-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-appgatewaynonprod-01",
                        "rgLocation":"UAENorth"
                    },
                    {
                        "rgName":"rsg-aen-identity-01",
                        "rgLocation":"UAENorth"
                    }
                ]
            }
        },
        "vnets":{
            "value":{
                "vnetSettings":[
                    {
                        "vNetName":"aen-hub-vnet-01",
                        "vNetAddressSpace":"10.200.0.0/22",
                        "vNetDnsServers":["10.200.1.132","10.200.1.133"],
                        "rgName":"rsg-aen-connectivity-01"
                    },
                    {
                        "vNetName":"aen-identity-vnet-01",
                        "vNetAddressSpace":"10.200.12.128/25",
                        "vNetDnsServers":["10.200.1.132","10.200.1.133"],
                        "rgName":"rsg-aen-identity-01"
                    }
                ],
                "peeringSettings":[
                    {
                        "vNetName":"aen-hub-vnet-01",
                        "rgName":"rsg-aen-connectivity-01",
                        "remoteVnetName":"aen-identity-vnet-01",
                        "remoteVNetSubscriptionId":"447c88e8-6ba0-4c01-9cd5-f4984c6e5f23",
                        "remoteVNetResourceGroup":"rsg-aen-identity-01",
                        "peeringName":"vnet-peering-hub-identity",
                        "allowForwardedTraffic":false,
                        "allowGatewayTransit":false,
                        "useRemoteGateways":false
                    },
                    {
                        "vNetName":"aen-identity-vnet-01",
                        "rgName":"rsg-aen-identity-01",
                        "remoteVnetName":"aen-hub-vnet-01",
                        "remoteVNetSubscriptionId":"447c88e8-6ba0-4c01-9cd5-f4984c6e5f23",
                        "remoteVNetResourceGroup":"rsg-aen-connectivity-01",
                        "peeringName":"vnet-peering-identity-hub",
                        "allowForwardedTraffic":false,
                        "allowGatewayTransit":false,
                        "useRemoteGateways":false
                    }
                ]
            }
        },
        "routes":{
            "value":{
                "udrTables":[
                    {
                        "routeTableName":"udr-aen-spoke-01",
                        "rgName":"rsg-aen-connectivity-01"
                    },
                    {
                        "routeTableName":"udr-aen-gateway-01",
                        "rgName":"rsg-aen-connectivity-01"
                    },
                    {
                        "routeTableName":"udr-aen-blackhole-01",
                        "rgName":"rsg-aen-connectivity-01"
                    }
                ],
                "udrSettings":[
                    {
                        "routeEntryName":"rt-blackhole",
                        "routeEntryAddressPrefix":"0.0.0.0/0",
                        "routeEntryType":"None",
                        "routeEntryNextHopIPAddress":"",
                        "routeTableName":"udr-aen-blackhole-01"
                    },  
                    {
                        "routeEntryName":"rt-default",
                        "routeEntryAddressPrefix":"0.0.0.0/0",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-spoke-01"
                    },
                    {
                        "routeEntryName":"rt-prod",
                        "routeEntryAddressPrefix":"10.200.4.0/22",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    },
                    {
                        "routeEntryName":"rt-uat",
                        "routeEntryAddressPrefix":"10.200.8.0/24",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    },
                    {
                        "routeEntryName":"rt-dev",
                        "routeEntryAddressPrefix":"10.200.9.0/24",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    },
                    {
                        "routeEntryName":"rt-test",
                        "routeEntryAddressPrefix":"10.200.10.0/24",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    },
                    {
                        "routeEntryName":"rt-sandbox",
                        "routeEntryAddressPrefix":"10.200.12.0/25",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    },
                    {
                        "routeEntryName":"rt-identity",
                        "routeEntryAddressPrefix":"10.200.12.128/25",
                        "routeEntryType":"VirtualAppliance",
                        "routeEntryNextHopIPAddress":"10.200.0.196",
                        "routeTableName":"udr-aen-gateway-01"
                    }
                ]
            }
        },
        "subnets":{
            "value":{
                "subnetSettings":[
                    {
                        "subnetName":"AzureFirewallSubnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.1.192/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"GatewaySubnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.1.0/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"udr-aen-gateway-01",
                        "udrRg":"rsg-aen-connectivity-01",
                        "createNsg":false
                    },
                    {
                        "subnetName":"AzureBastionSubnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.1.64/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"shdsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.1.128/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"udr-aen-spoke-01",
                        "udrRg":"rsg-aen-connectivity-01",
                        "createNsg":true
                    },
                    {
                        "subnetName":"pvtendpointsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.2.0/24",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"udr-aen-spoke-01",
                        "udrRg":"rsg-aen-connectivity-01",
                        "createNsg":true
                    },
                    {
                        "subnetName":"fwtrustsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.0.192/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"fwuntrustsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.0.128/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"fwmgmtsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.0.0/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"fwhasnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.0.64/26",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"agwprodsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.3.0/25",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"agwnonprodsnet",
                        "vNetName":"aen-hub-vnet-01",
                        "subnetAddress":"10.200.3.128/25",
                        "rgName":"rsg-aen-connectivity-01",
                        "udr":"",
                        "udrRg":"",
                        "createNsg":false
                    },
                    {
                        "subnetName":"addsnet",
                        "vNetName":"aen-identity-vnet-01",
                        "subnetAddress":"10.200.12.128/27",
                        "rgName":"rsg-aen-identity-01",
                        "udr":"udr-aen-spoke-01",
                        "udrRg":"rsg-aen-connectivity-01",
                        "createNsg":true
                    }
                ]
            }
        },
        "windowsVMs":{
            "value":{
                "vmSettings":[
                    {
                        "vmName":"aendns01",
                        "rgName":"rsg-aen-sharedservices-01",
                        "vNetName":"aen-hub-vnet-01",
                        "vNetResourceGroup":"rsg-aen-connectivity-01",
                        "subnetName":"shdsnet",
                        "vmZones":["1"],
                        "osDiskType":"StandardSSD_LRS",
                        "osPublisher":"microsoftwindowsserver",
                        "osOffer":"windowsserver",
                        "osSku":"2022-datacenter-g2",
                        "vmSize":"Standard_D2s_v5",
                        "adminUsername":"localadmin",
                        "adminPassword":"Pa$$w0rd123*"
                    },
                    {
                        "vmName":"aendns02",
                        "rgName":"rsg-aen-sharedservices-01",
                        "vNetName":"aen-hub-vnet-01",
                        "vNetResourceGroup":"rsg-aen-connectivity-01",
                        "subnetName":"shdsnet",
                        "vmZones":["2"],
                        "osDiskType":"StandardSSD_LRS",
                        "osPublisher":"microsoftwindowsserver",
                        "osOffer":"windowsserver",
                        "osSku":"2022-datacenter-g2",
                        "vmSize":"Standard_D2s_v5",
                        "adminUsername":"localadmin",
                        "adminPassword":"Pa$$w0rd123*"
                    },
                    {
                        "vmName":"aendc01",
                        "rgName":"rsg-aen-identity-01",
                        "vNetName":"aen-identity-vnet-01",
                        "vNetResourceGroup":"rsg-aen-identity-01",
                        "subnetName":"addsnet",
                        "vmZones":["1"],
                        "osDiskType":"StandardSSD_LRS",
                        "osPublisher":"microsoftwindowsserver",
                        "osOffer":"windowsserver",
                        "osSku":"2022-datacenter-g2",
                        "vmSize":"Standard_D2s_v5",
                        "adminUsername":"localadmin",
                        "adminPassword":"Pa$$w0rd123*"
                    },
                    {
                        "vmName":"aendc02",
                        "rgName":"rsg-aen-identity-01",
                        "vNetName":"aen-identity-vnet-01",
                        "vNetResourceGroup":"rsg-aen-identity-01",
                        "subnetName":"addsnet",
                        "vmZones":["2"],
                        "osDiskType":"StandardSSD_LRS",
                        "osPublisher":"microsoftwindowsserver",
                        "osOffer":"windowsserver",
                        "osSku":"2022-datacenter-g2",
                        "vmSize":"Standard_D2s_v5",
                        "adminUsername":"localadmin",
                        "adminPassword":"Pa$$w0rd123*"
                    },
                    {
                        "vmName":"aenadcnct01",
                        "rgName":"rsg-aen-identity-01",
                        "vNetName":"aen-identity-vnet-01",
                        "vNetResourceGroup":"rsg-aen-identity-01",
                        "subnetName":"addsnet",
                        "vmZones":[],
                        "osDiskType":"StandardSSD_LRS",
                        "osPublisher":"microsoftwindowsserver",
                        "osOffer":"windowsserver",
                        "osSku":"2022-datacenter-g2",
                        "vmSize":"Standard_D2s_v5",
                        "adminUsername":"localadmin",
                        "adminPassword":"Pa$$w0rd123*"
                    }
                ]
            }
        },
        "linuxVMs":{
            "value":{
                "vmSettings":[]
            }
        },
        "azFirewall": {
            "value":{
                "buildAzFirewall":false,
                "name":"Contoso-Hub-AzFW-01",
                "rgName":"rsg-aen-connectivity-01",
                "vnetName":"aen-hub-vnet-01",
                "tier":"Standard"
            }
        },
        "azBastion": {
            "value":{
                "buildAzBastion":false,
                "name":"aen-bastion-01",
                "rgName":"rsg-aen-connectivity-01",
                "vnetName":"aen-hub-vnet-01",
                "vNetResourceGroup":"rsg-aen-connectivity-01",
                "sku":"Standard",
                "bastionPublicIpName":"aen-bastion-01-pip",
                "disableCopyPaste":false,
                "enableFileCopy":true,
                "enableIpConnect":true,
                "enableShareableLink":true,
                "enableTunneling":false
            }
        },
        "azVpnGateway": {
            "value":{
                "buildVpnGateway":false,
                "name":"aen-gw-vpn-01",
                "rgName":"rsg-aen-connectivity-01",
                "vpnType":"RouteBased",
                "vnetName":"aen-hub-vnet-01",
                "vNetResourceGroup":"rsg-aen-connectivity-01",
                "gatewaySku":"VpnGw3AZ",
                "localGatewayName":"aen-lgw-01",
                "localGatewayIpAddress":"91.72.224.106",
                "localAddressPrefix":["10.0.0.0/8","172.16.0.0/12"],
                "gatewayPublicIpName":"aen-gw-vpn-01-pip"
            }
        },
        "azAppGatewayV2": {
            "value":{
                "settings":[
                    {
                        "build":true,
                        "name":"aen-appgw-prod-01",
                        "rgName":"rsg-aen-appgatewayprd-01",
                        "gwTier":"WAF_v2",
                        "vnetName":"aen-hub-vnet-01",
                        "vNetResourceGroup":"rsg-aen-connectivity-01",
                        "subnetName":"agwprodsnet",
                        "privateIp":"10.200.3.4",
                        "publicIpName":"aen-appgw-prod-01-pip",
                        "publicIpSku":"Standard",
                        "allocationMethod":"Static",
                        "capacity":2,
                        "autoScaleMaxCapacity":7
                    },
                    {
                        "build":true,
                        "name":"aen-appgw-nonprod-01",
                        "rgName":"rsg-aen-appgatewaynonprod-01",
                        "gwTier":"WAF_v2",
                        "vnetName":"aen-hub-vnet-01",
                        "vNetResourceGroup":"rsg-aen-connectivity-01",
                        "subnetName":"agwnonprodsnet",
                        "privateIp":"10.200.3.132",
                        "publicIpName":"aen-appgw-nonprod-01-pip",
                        "publicIpSku":"Standard",
                        "allocationMethod":"Static",
                        "capacity":2,
                        "autoScaleMaxCapacity":7
                    }
                ]
            }
        },
        "logAnalyticsWorkspace": {
            "value":{
                "settings":[
                    {
                        "build":false,
                        "name":"law-aen-ops-01",
                        "rgName":"rsg-aen-management-prd",
                        "retention":30,
                        "publicNetworkAccessForIngestion":"Enabled",
                        "publicNetworkAccessForQuery":"Enabled"
                    },
                    {
                        "build":false,
                        "name":"law-aen-sec-01",
                        "rgName":"rsg-aen-management-prd",
                        "retention":30,
                        "publicNetworkAccessForIngestion":"Enabled",
                        "publicNetworkAccessForQuery":"Enabled"
                    }
                ]
            }
        }
    },
    "variables": {},
    "resources": [],
    "outputs": {},
    "functions": []
}
